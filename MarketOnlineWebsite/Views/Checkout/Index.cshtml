@model MarketOnlineWebsite.ModelViews.PurchaseVM
@{
    ViewData["Title"] = "Mua hàng";
    Layout = "~/Views/Shared/_Layout.cshtml";
    List<MarketOnlineWebsite.ModelViews.CartItem> Carts = ViewBag.Cart;
}
@section Styles {
    <style type="text/css">
    .nice-select .list {
         border-radius: 0px;
         overflow-y: auto;
         overflow: hidden;
         max-height: 200px;
         overflow-y: scroll;
    }
    .nice-select .option:hover, .nice-select .option.focus, .nice-select .option.selected.focus {
         color: red;
         background: none;
    }
    td.centerTotal {
         padding-left: 90px;
    }
    .sizeFont {
        font-size:14px;
    }

    .fontBill {
        font-family:sans-serif;
    }

    .settingShow {
       font-size: 16px;
       padding-top: 10px;
       padding-left: 20px;
       color: rgb(150 0 0);
       line-height: 30px;
       margin-top: 75px;
    }
    </style>


}
<main class="main-content">
    <div class="breadcrumb-area breadcrumb-height" data-bg-image="Userassets/images/breadcrumb/bg/1-1.jpg">
        <div class="container h-100">
            <div class="row h-100">
                <div class="col-lg-12">
                    <div class="breadcrumb-item">
                        <h2 class="breadcrumb-heading">THÔNG TIN MUA HÀNG</h2>
                        <ul>
                            <li>
                                <a href="/">Home <i class="pe-7s-angle-right"></i></a>
                            </li>
                            <li>THÔNG TIN MUA HÀNG</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="checkout-area section-space-y-axis-100">
        <div class="container">
            <form asp-controller="Checkout" asp-action="Index" method="post" id="submit_form">
                <input hidden asp-for="CustomerId" />
            <div class="row">
                <div class="col-lg-6 col-12">
                        <div class="checkbox-form">
                            <h3>THÔNG TIN GIAO HÀNG</h3>
                            <div class="row sizeFont">
                                <div class="col-md-12">
                                    <div class="checkout-form-list">
                                        <label>Họ và Tên*</label>
                                        <input asp-for="FullName" placeholder="Họ và Tên" type="text">
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="checkout-form-list">
                                        <label>Số điện thoại*</label>
                                        <input asp-for="Phone" placeholder="Số điện thoại" type="text">
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="checkout-form-list">
                                        <label>Email*</label>
                                        <input asp-for="Email" placeholder="Số điện thoại" type="text">
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="checkout-form-list">
                                        <label>Địa chỉ nhận hàng*</label>
                                        <input asp-for="Address" placeholder="Địa chỉ nhận hàng" type="text">
                                        <span asp-validation-for="Address" class="text-danger"></span>
                                    </div>
                                </div>

                                <div class="col-md-4">
                                        <div class="country-select">
                                            <label>Tỉnh/thành<span>*</span></label>
                                            <select asp-for="TinhThanh" asp-items="ViewBag.lsLTinhThanh" class="myniceselect nice-select wide">
                                                <option value="0" data-display="Tỉnh/Thành">Tỉnh/Thành</option>
                                            </select>
                                             <span asp-validation-for="TinhThanh" class="text-danger"></span>
                                        </div>
                                 </div>
                               <div class="col-md-4">
                                    @if(Model.QuanHuyen !=null )
                                    {
                                         <div class="country-select">
                                                <label>Quận/Huyện <span>*</span></label>
                                                <select asp-for="QuanHuyen" asp-items="ViewBag.lsLQuanHuyen" class="myniceselect nice-select wide">
                                                <option value="0" disabled selected>Quận/Huyện</option>                                      
                                                </select>
                                                <span asp-validation-for="QuanHuyen" class="text-danger"></span>

                                        </div>
                                    }
                                    else
                                    {
                                         <div class="country-select">
                                                <label>Quận/Huyện <span>*</span></label>
                                                <select asp-for="QuanHuyen" class="myniceselect nice-select wide">
                                                <option value="0" disabled selected>Quận/Huyện</option>                                      
                                                </select>
                                                <span asp-validation-for="QuanHuyen" class="text-danger"></span>
                                        </div>                                       
                                    }

                                 </div>
                               <div class="col-md-4">
                                    @if (Model.PhuongXa != null)
                                    {
                                      <div class="country-select">
                                            <label>Phường/Xã<span>*</span></label>
                                            <select asp-for="PhuongXa" asp-items="ViewBag.LsPhuongXa"   class="myniceselect nice-select wide">
                                                 <option value="0" disabled selected >Phường/Xã</option>
                                            </select>
                                            <span asp-validation-for="PhuongXa" class="text-danger"></span>
                                        </div>  
                                    }
                                    else
                                    {
                                      <div class="country-select">
                                            <label>Phường/Xã<span>*</span></label>
                                            <select asp-for="PhuongXa" class="myniceselect nice-select wide">
                                                 <option value="0" disabled selected >Phường/Xã</option>
                                            </select>
                                            <span asp-validation-for="PhuongXa" class="text-danger"></span>
                                        </div>                                      
                                    }
                                </div>
                                <div class="order-notes col-md-12">
                                        <div class="checkout-form-list checkout-form-list-2">
                                            <label style="margin-top: 25px;">Ghi chú</label>
                                     <textarea asp-for="Note" placeholder="Nội dung ghi chú" type="text"> </textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
           
                </div>
                <div class="col-lg-6 col-12">
                    <div class="your-order">
                        <h3>THÔNG TIN ĐƠN HÀNG</h3>
                        <div class="your-order-table table-responsive">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th style="padding-right: 100px;">#</th>
                                        <th class="cart-product-name" style="padding-right: 59px;">Tên sản phẩm</th>
                                        <th class="cart-product-total">Thành tiền</th>
                                    </tr>
                                </thead>
                                <tbody>
                                        @if(Carts.Count() > 0)
                                        {
                                           var rowNumber = 1;
                                           foreach (var item in Carts)
                                           {
                                                <tr class="cart_item sizeFont">
                                                    <td style="padding-left:33px;" >@rowNumber</td>
                                                    <td class="cart-product-name" style="padding-left: 20px;">@item.product.ProductName <label class="product-quantity">
                                                        × @item.amout</label></td>
                                                    <td class="cart-product-total centerTotal" style="padding-left: 57px;"><span class="amount">@item.TotalMoney.ToString("#,##0") VNĐ</span></td>
                                                </tr>
                                                rowNumber++;
                                            }
                                           
                                        }

                                </tbody>
                            </table>
                        </div>
                        <br />
                        <tfoot>
                        <tr class="order-total">
                           <strong> <th style="font-size:18px">SỐ TIỀN PHẢI THANH TOÁN</th>
                            <td><span class="amount centerTotal" style="font-size:18px;padding-left: 153px;">@Carts.Sum(x=>x.TotalMoney).ToString("#,##0") VNĐ</span></td>
                        </strong>
                        </tr>
                        </tfoot>
                        <div class="payment-method fontBill" >
                             <br />
                                        <label>Chọn phương thúc thanh toán<span>*</span></label>
                                        <br />
                                        <br />
                                        <div class="country-select">
                                            <select asp-for="PaymentID" id="myCheck" class="myniceselect nice-select wide">
                                                <option  value="" disabled selected>Chọn phương thúc thanh toán</option>
                                                <option  value="1" data-display="Thanh toán khi nhận hàng (COD)">Thanh toán khi nhận hàng (COD)</option>
                                                <option   value="2" data-display="Chuyển khoản ngân hàng">Chuyển khoản ngân hàng</option>
                                                <option  value="3" data-display="Thanh toán qua MOMO">Thanh toán qua MOMO</option>
                                               <option value="4" data-display="Thanh toán qua PayPal">Thanh toán qua PayPal</option>
                                            </select>
                                         <span asp-validation-for="PaymentID" class="text-danger"></span>
                                            @* <span asp-validation-for="PaymentID" class="text-danger"></span>*@
                                        </div>
                    

                            <div class="payment-accordion fontBill">
                                <div class="order-button-payment">
                                    <div >
                                            <p id="text1" style="display:none" class="settingShow" >
                                               KHÁCH HÀNG CÓ SẼ PHẢI THANH TOÁN KHI NHẬN HÀNG
                                            </p>
                                            <p id="text3" style="display:none" class="settingShow">
                                                &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; THÔNG TIN TÀI KHOẢN MOMO <br />
                                            SỐ ĐIỆN THOẠI : 02102012010 <BR />
                                            TÊN TÀI KHOẢN : NHÓM 9
                                            </p>
                                            <p id="text2" style="display:none" class="settingShow">
                                                &nbsp;  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; THÔNG TIN CHUYỂN KHOẢN QUA NGÂN HÀNG <br />
                                            SỐ TÀI KHOẢN    : 1812010310311 <br /> 
                                            CHỦ TÀI KHOẢN   : NHÓM 9 <br /> 
                                            NGÂN HÀNG       : VietCombank
                                            </p>
                                    </div>
                                        <input value="ĐẶT HÀNG" type="submit" id="add_to_Cart">
                                   
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            </form>
           
        </div>
    </div>
</main>

@section Scripts {
<script>
    $(document).ready(function () {
       
        $('select').niceSelect();
            $(function () {
                 console.log("alo")
                let tinhthanh =  localStorage.getItem("tinhthanh");
                let quanhuyen =  localStorage.getItem("quanhuyen")
                let phuongxa = localStorage.getItem("phuongxa")

                $("#TinhThanh").change(function () {
                    var locationid = $('#TinhThanh').val();
                    $.ajax({
                        url: '/Location/QuanHuyenList',
                        type: "GET",
                        dataType: "JSON",
                        data: { LocationId: locationid },
                        success: function (QuanHuyens) {
                            $("#QuanHuyen").empty();// clear before appending new list
                            $("#PhuongXa").empty();
                            var strPhuongXa = '<option value="" disabled selected>Phường/Xã</option>';
                            console.log("strPhuongXa", strPhuongXa)
                            $("#PhuongXa").append(strPhuongXa);
                            var strQuanHuyen = '<option value="" disabled selected>Quận/Huyện</option>';
                            $("#QuanHuyen").append(strQuanHuyen);
                            $.each(QuanHuyens, function (i, item) {
                                      console.log("item", item.locationId)
                                      var option = '<option value ="' + item.locationId + '">' + item.name + '</option>';
                                        //var option = `<option value = ${item.locationId}> test </option>`
                                    $("#QuanHuyen").append(option);
                            });
                            $('select').niceSelect('update');
                        }
                    });
                });
                $("#QuanHuyen").change(function () {
                    //var locationid = $('#QuanHuyen').val();
                       ////var locationid = 603;
                       var locationid = $('#QuanHuyen').val();
                       console.log("tHANH PHO DA CHON", locationid)
                        $.ajax({
                            url: '/Location/PhuongXaList',
                            type: "GET",
                            dataType: "JSON",
                            data: { LocationId: locationid },
                            success: function (PhuongXaList) {
                                $("#PhuongXa").empty();
                                var readonly = '<option value="" disabled selected>Phường/Xã</option>';
                                $("#PhuongXa").append(readonly);
                                $.each(PhuongXaList, function (i, item) {
                                        var option = '<option value ="' + item.locationId+ '">' + item.name + '</option>';
                                        $("#PhuongXa").append(option);
                                });
                                $('select').niceSelect('update');
                            }
                     });
            });
        });

        //if($("#TinhThanh").val() != 0) {
        //    var locationid = $('#TinhThanh').val();
        //    $.ajax({
        //        url: '/Location/QuanHuyenList',
        //        type: "GET",
        //        dataType: "JSON",
        //        data: { LocationId: locationid },
        //        success: function (QuanHuyens) {
        //            $("#QuanHuyen").empty();// clear before appending new list
        //            $("#PhuongXa").empty();
        //            var strPhuongXa = '<option value="" disabled selected>Phường/Xã</option>';
        //            console.log("strPhuongXa", strPhuongXa)
        //            $("#PhuongXa").append(strPhuongXa);
        //            var strQuanHuyen = '<option value="" disabled selected>Quận/Huyện</option>';
        //            $("#QuanHuyen").append(strQuanHuyen);
        //            $.each(QuanHuyens, function (i, item) {
        //                        console.log("item", item.locationId)
        //                        var option = '<option value ="' + item.locationId + '">' + item.name + '</option>';
        //                        //var option = `<option value = ${item.locationId}> test </option>`
        //                    $("#QuanHuyen").append(option);
        //            });
        //            $('select').niceSelect('update');
        //        }
        //    });
        //    console.log($('#TinhThanh').val());
        //}
    });
</script> 

<script>
    $(function () {
        $("#myCheck").change(function () {
            if ($(this).val() == "1") {
                $("#text1").show();
                $("#text2").hide();
                $("#text3").hide();
            } else if ($(this).val() == "2") {
                $("#text2").show();
                $("#text1").hide();
                $("#text3").hide();
            }
            else if ($(this).val() == "3") {
                $("#text3").show();
                $("#text2").hide();
                $("#text1").hide();

            }
        });
    });
</script>
}
